<div id=uploadfiles_view>
  <% unless flash.now[:message].nil? -%>
    <h1> <%= flash.now[:message]%> </h1>
    <% end -%>
    <fieldset>
    <div id="editrelease_view">
    <table class=ReleaseShow >
<tr><th> <%= Release.columns_hash['version'].human_name  -%> : </th>
<td> <%= h(@release.version) %> </td>
</tr>
<tr><th> <%= Release.columns_hash['due'].human_name  -%> : </th>

<td> <%= h(@release.due) %> </td>
</tr>
<tr><th> <%= Release.columns_hash['status'].human_name  -%> : </th>
<td> <%= h(Release.status_to_s(@release.status)) %> </td>
</tr>
</table>
        <%= link_to_remote _('[Edit]'),:url => editrelease_release_url({
            :project_id => @project.id,
            :id => @release.id,
          }), :update => "editrelease_view"
        %>
        <%= link_to _('[Delete]'), delete_release_url(
          {
            :project_id => @project.id, 
            :id => @release.id
          }), 
            :confirm => "#{_('[Delete]')}?", 
          :method => :post
        %>
        <%= link_to _('[Add release news]'), new_release_news_url({
            :release_id => @release.id,
          })
        %>
    </div>
    </fieldset>
    <fieldset>
    <h1>Files: </h1>
    <% if @release.fileentity.empty? -%>
      <h3>No File in Release</h3>
    <%end%>
    <% @release.fileentity.each_with_index do |f, i|%>
    <div id=<%= "editfiles_view#{i}" %>>
<table class=FileItem >
<tr>
<th> <%=  Fileentity.columns_hash['path'].human_name -%> : </th>
<td> <%= h(f.path) %> </td>
</tr>
<tr>
<th> <%=  Fileentity.columns_hash['description'].human_name -%> : </th>
<td> <%= h(f.description) %>  </td>
</tr>
<tr>
<th> <%=  Fileentity.columns_hash['size'].human_name -%> : </th>
<td> <%= number_to_human_size(f.size) %> </td>
</tr>
</table>
        <%= link_to_remote _('[Edit]'),:url => editfile_release_url({
            :project_id => @project.id,
            :id => @release.id,
            :editfile_id => f.id,
            :div_id => "editfiles_view#{i}",
          }), :update => "editfiles_view#{i}"
        %>
        <%= link_to_remote _('[Delete]'),:url => removefile_release_url({
            :project_id => @project.id,
            :id => @release.id,
            :removefile_id => f.id
          }),
          :confirm => 'Delete?', 
          :update => "uploadfiles_view"
        %>
	<%= link_to _('Download'), download_url(:project_name => @project.name, 
					       :release_version => @release.version,
					       :file_name => f.path )
        %>
    </div>
    <hr>
    <%end%>
    </fieldset>
    <fieldset>
    <% form_remote_tag :update => "uploadfiles_view", :url => addfiles_release_url( { 
        :project_id => @project.id, 
        :id => @release.id  }) do -%>
  
      <h2><%=_('Project Upload Repository')%></h2>
      <h3><%=_('Current Dir')%>: <%= @current_dir %> </h3>
  
        <div id=Uploadfile_selection>
        <%= submit_to_remote 'reload_button', _('Reload'), :url => reload_release_url({
            :project_id => @project.id,
            :id => @release.id,
           }), :update => "uploadfiles_view" %>
        <%=submit_tag _('Add File') %>
        <%= submit_to_remote 'delete_files', _('Delete'), :url => delete_files_release_url({
            :project_id => @project.id,
            :id => @release.id,
           }), :update => "uploadfiles_view" %>

        <% unless @uploadfiles.empty? -%>
          <select name=uploadfiles[] id=release_file_selection multiple size=10>
      
            <% @uploadfiles.sort.each do |file| -%>
              <option id=release_file value="<%= h(file) -%>">  
                <%= h(file) %>
              </option>
      
            <% end -%>  
      
          </select>
        <% else -%>
          <h5><%=  _('File_not_found') %></h5>
        <%end -%>
      </div>
    <% end -%>
 
<ol>
  <li>To add files into current release, you must upload  them first.</li>
  <li>Choose your upload protocol below:
    <ul>
      <li>Web upload (On your own risk, for larger files or unstable connection please select FTP protocol.)<br/>
<% form_tag ({:project_id => @project.id, :id => @release.id, :action => 'web_upload'}, :multipart => true) do %>
  <% for i in 1..5 %>
    <%= file_field_tag("upload_file_#{i}") %><br/>
  <% end %>
  <%= submit_tag _("Upload") %>
  <%= submit_tag _("Reset"), :type => 'reset' %> 
<% end %>
      </li>
      <li>FTP(<%= link_to OPENFOUNDRY_FTP_URL+@current_dir, OPENFOUNDRY_FTP_URL+@current_dir, {:target => '_blank'} %>), Please RELOAD prior each upload.<br/>
      Guide: [<%= link_to _("How to Upload?"), "http://webhosting.openfoundry.org/how_to_upload.html", {:target => '_blank'} %>]
      </li>
    </ul>
  </li>
  <li>You must manually ADD FILE from list displayed right above for each successful upload.</li>
</ol>  

      </fieldset>
  
  </div>
