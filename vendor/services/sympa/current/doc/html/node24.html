<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 2002-2-1 (1.70)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>23. Bounce management</TITLE>
<META NAME="description" CONTENT="23. Bounce management">
<META NAME="keywords" CONTENT="sympa">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<META NAME="Generator" CONTENT="LaTeX2HTML v2002-2-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="sympa.css">

<LINK REL="next" HREF="node25.html">
<LINK REL="previous" HREF="node23.html">
<LINK REL="up" HREF="sympa.html">
<LINK REL="next" HREF="node25.html">
</HEAD>

<BODY TEXT="#000000" BGCOLOR="#ffffff">
<!--Navigation Panel-->
<A NAME="tex2html1464"
  HREF="node25.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html1458"
  HREF="sympa.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html1452"
  HREF="node23.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html1460"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html1462"
  HREF="node30.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html1465"
  HREF="node25.html">24. Antivirus</A>
<B> Up:</B> <A NAME="tex2html1459"
  HREF="sympa.html">Sympa Mailing Lists Management Software version</A>
<B> Previous:</B> <A NAME="tex2html1453"
  HREF="node23.html">22. Shared documents</A>
 &nbsp; <B>  <A NAME="tex2html1461"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html1463"
  HREF="node30.html">Index</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL>
<LI><A NAME="tex2html1466"
  HREF="node24.html#SECTION002410000000000000000">23.1 VERP</A>
</UL>
<!--End of Table of Child-Links-->
<HR>

<H1><A NAME="SECTION002400000000000000000">
23. Bounce management</A>
</H1>

<P>
<I>Sympa</I> allows bounce (non-delivery report) management. This
prevents list owners from receiving each bounce (1 per message
sent to a bouncing subscriber) in their own mailbox. Without
automatic processing of bounces, list owners either go
mad, or just delete them without further attention.

<P>
Bounces are received at mylist-owner address (note that the -owner 
suffix can be customized, see&nbsp;<A HREF="node8.html#kw-return-path-suffix">7.8.4</A>, 
page&nbsp;<A HREF="node8.html#kw-return-path-suffix"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="crossref.png"></A>), which should
be sent to the <A NAME="11607"></A><TT>bouncequeue</TT> program via aliases :

<P><PRE>
	\samplelist-owner: "|/usr/local/sympa-stable/bin/bouncequeue \samplelist"
</PRE>

<P>
<A NAME="11610"></A><TT>bouncequeue</TT> (see <A HREF="node3.html#binaries">2.2</A>, page&nbsp;<A HREF="node3.html#binaries"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="crossref.png"></A>) stores bounces in a
<A NAME="11613"></A><TT>/usr/local/sympa-stable/spool/bounce/</TT> spool.

<P>
Bounces are then processed by the <A NAME="11616"></A><TT>bounced.pl</TT> daemon.
This daemon analyses bounces to find out which
e-mail addresses are concerned and what kind of error was generated.
If bouncing addresses match a subscriber's address, information 
is stored in the <I>Sympa</I> database (in subscriber_table). Moreover, the most recent
bounce itself is archived in <A NAME="11620"></A><TT>bounce_path/mylist/email</TT>
(where bounce_path is defined in a <A NAME="11623"></A><TT>wwsympa.conf</TT> parameter and
email is the user e-mail address).

<P>
When reviewing a list, bouncing addresses are tagged as bouncing.
You may access further information such as dates of first and last bounces,
number of received bounces for the address, the last bounce itself.

<P>
With these informations, the automatic bounce management is possible:

<P>

<UL>
<LI>The automatic task <A NAME="11626"></A><TT>eval_bouncer</TT> gives a score foreach bouncing user.
  The score, between 0 to 100, allows the classification of bouncing users in two levels.
  (Level 1 or 2). 
  According to the level, automatic actions are executed periodicaly by <A NAME="11629"></A><TT>process_bouncers</TT>
  task.

<P>
</LI>
<LI>The score evaluation main parameters are: 

<P>
<A NAME="11632"></A><TT>Bounces count</TT>: The number of bouncing messages received by sympa for the user.

<P>
<A NAME="11635"></A><TT>Type rate</TT> : Bounces are classified depending on the type of errors generated on the user
  side. If the error type is "mailbox is full" (ie a temporary 4.2.2 error type) the type rate will be
  0.5 whereas permanent errors (5.x.x) have a type rate equal to 1.

<P>
<A NAME="11638"></A><TT>Regularity rate</TT> : This rate tells if the bounces where received regularly, compared to list
 traffic. The list traffic is deduced from <A NAME="11641"></A><TT>msg_count</TT> file data.

<P><PRE>
      The score formula is  :
  
      Score = bounce_count * type_rate * regularity_rate
</PRE>

<P>
To avoid making decisions (ie defining a score) without enough relevant data, the score is not
  evaluated if :

<P>

<UL>
<LI>The number of the number of received bounces is lower than <A NAME="11644"></A><TT>minimum_bouncing_count</TT> 
	(see <A HREF="node8.html#kw-minimum-bouncing-count">7.8.9</A>, page&nbsp;<A HREF="node8.html#kw-minimum-bouncing-count"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="crossref.png"></A>)

<P>
</LI>
<LI>The bouncing period is shorter than <A NAME="11647"></A><TT>minimum_bouncing_period</TT> 
	(see <A HREF="node8.html#kw-minimum-bouncing-period">7.8.10</A>, page&nbsp;<A HREF="node8.html#kw-minimum-bouncing-period"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="crossref.png"></A>)

<P>
</LI>
</UL>

<P>
</LI>
<LI>You can define the limit between each level via the <B>List configuration pannel</B>, 
  in subsection <B>Bounce settings</B>. (see <A HREF="node21.html#rate">20.5.2</A>) The principle consists in
  associating a score interval with a level.

<P>
</LI>
<LI>You can also define wich action must be applied on each category of user.(see <A HREF="node21.html#action">20.5.2</A>)
  Each time an action will be done, a notification email will be send to the person of your choice.
  (see <A HREF="node21.html#notification">20.5.2</A>)

<P>
</LI>
</UL>

<P>

<H1><A NAME="SECTION002410000000000000000"></A>
<A NAME="verp"></A>
<BR>
23.1 VERP
</H1>

<P>
VERP (Variable Envelop Return Path) is used to ease automatic recognition of
        subscribers email address when receiving a bounce. If VERP is enabled, the subscriber address is encoded
        in the return path itself so Sympa bounce management processus (bounced) will use the address the bounce
        was received for to retreive the subscriber email. This is very usefull because sometimes, non delivery
        report don't contain the initial subscriber email address but an alternative address where messages
        are forwarded. VERP is the only solution to detect automaticaly these subscriber errors but the cost
        of VERP is significant, indeed VERP requires to distribute a separate message for each subscriber and
        break the bulk emailer grouping optimization.

<P>
In order to benefit from VERP and keep distribution process fast, Sympa enables VERP only for a share
        of the list members. If texttt <A NAME="11650"></A><TT>verp_rate</TT> (see <A HREF="node8.html#kw-verp-rate">7.8.1</A>,page&nbsp;<A HREF="node8.html#kw-verp-rate"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="crossref.png"></A>) is 10% then after 10 messages distributed in the list
        all subscribers have received at least one message where VERP was enabled. Later distribution message enable
        VERP also for all users where some bounce wer collected and analysed by previous VERP mechanism. 

<P>

<HR>
<!--Navigation Panel-->
<A NAME="tex2html1464"
  HREF="node25.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html1458"
  HREF="sympa.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html1452"
  HREF="node23.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html1460"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html1462"
  HREF="node30.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html1465"
  HREF="node25.html">24. Antivirus</A>
<B> Up:</B> <A NAME="tex2html1459"
  HREF="sympa.html">Sympa Mailing Lists Management Software version</A>
<B> Previous:</B> <A NAME="tex2html1453"
  HREF="node23.html">22. Shared documents</A>
 &nbsp; <B>  <A NAME="tex2html1461"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html1463"
  HREF="node30.html">Index</A></B> 
<!--End of Navigation Panel-->
<ADDRESS>
root
2006-09-25
</ADDRESS>
</BODY>
</HTML>
