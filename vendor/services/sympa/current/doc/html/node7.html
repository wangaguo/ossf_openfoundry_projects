<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 2002-2-1 (1.70)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>6. Mail aliases</TITLE>
<META NAME="description" CONTENT="6. Mail aliases">
<META NAME="keywords" CONTENT="sympa">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<META NAME="Generator" CONTENT="LaTeX2HTML v2002-2-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="sympa.css">

<LINK REL="next" HREF="node8.html">
<LINK REL="previous" HREF="node6.html">
<LINK REL="up" HREF="sympa.html">
<LINK REL="next" HREF="node8.html">
</HEAD>

<BODY TEXT="#000000" BGCOLOR="#ffffff">
<!--Navigation Panel-->
<A NAME="tex2html875"
  HREF="node8.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html869"
  HREF="sympa.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html863"
  HREF="node6.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html871"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html873"
  HREF="node30.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html876"
  HREF="node8.html">7. sympa.conf parameters</A>
<B> Up:</B> <A NAME="tex2html870"
  HREF="sympa.html">Sympa Mailing Lists Management Software version</A>
<B> Previous:</B> <A NAME="tex2html864"
  HREF="node6.html">5. Upgrading Sympa</A>
 &nbsp; <B>  <A NAME="tex2html872"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html874"
  HREF="node30.html">Index</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL>
<LI><A NAME="tex2html877"
  HREF="node7.html#SECTION00710000000000000000">6.1 Robot aliases</A>
<LI><A NAME="tex2html878"
  HREF="node7.html#SECTION00720000000000000000">6.2 List aliases</A>
<LI><A NAME="tex2html879"
  HREF="node7.html#SECTION00730000000000000000">6.3 Alias manager</A>
<LI><A NAME="tex2html880"
  HREF="node7.html#SECTION00740000000000000000">6.4 Virtual domains</A>
</UL>
<!--End of Table of Child-Links-->
<HR>

<H1><A NAME="SECTION00700000000000000000"></A>
    <A NAME="aliases"></A>    <A NAME="738"></A>
<BR>
6. Mail aliases
</H1>

<P>
Mail aliases are required in Sympa for <A NAME="7735"></A><TT>sympa.pl</TT> to receive mail commands and 
list messages. Management of these aliases management will depend on the MTA (<A NAME="7738"></A><TT>sendmail</TT>, <A NAME="7741"></A><TT>qmail</TT>,
<A NAME="7744"></A><TT>postfix</TT>, <A NAME="7747"></A><TT>exim</TT>) you're using, where you store aliases and whether
you are managing virtual domains or not.

<P>

<H1><A NAME="SECTION00710000000000000000"></A>
   <A NAME="robot-aliases"></A>    <A NAME="746"></A>
<BR>
6.1 Robot aliases
</H1>

<P>
An electronic list manager such as <I>Sympa</I> is built around two processing steps:

<P>

<UL>
<LI>a message sent to a list or to <I>Sympa</I> itself
        (commands such as subscribe or unsubscribe) is received
        by the SMTP server. The SMTP server, on reception of this message, runs the
        <A NAME="7752"></A><TT>queue</TT> program (supplied in this package) to store
        the message in a spool.

<P>
</LI>
<LI>the <A NAME="7755"></A><TT>sympa.pl</TT> daemon, set in motion at
        system startup, scans this spool. As soon as it
        detects a new message, it processes it and performs the
        requested action (distribution or processing of a command).

<P>
</LI>
</UL>

<P>
To separate the processing of commands (subscription,
unsubscription, help requests, etc.) from the processing of messages destined for mailing
lists, a special mail alias is reserved for administrative requests, so
that <I>Sympa</I> can be permanently accessible to users. The following
lines must therefore be added to the <A NAME="7759"></A><TT>sendmail</TT> alias file
(often <A NAME="7762"></A><TT>/etc/aliases</TT>):

<P>
<BLOCKQUOTE>
sympa:             "| /usr/local/sympa-stable/bin/queue sympa@my.domain.org"
<BR>
listmaster: 	   "| /usr/local/sympa-stable/bin/queue listmaster@my.domain.org"
<BR>
bounce+*:          "| /usr/local/sympa-stable/bin/bouncequeue sympa@my.domain.org"
<BR>
sympa-request:     postmaster
<BR>
sympa-owner:       postmaster
<BR>
</BLOCKQUOTE>

<P>
Note: if you run <I>Sympa</I> virtual hosts, you will need one <TT>sympa</TT>
alias entry per virtual host (see virtual hosts section, <A HREF="node15.html#virtual-robot">14</A>,
page&nbsp;<A HREF="node15.html#virtual-robot"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="crossref.png"></A>).

<P>
<TT>sympa-request</TT> should be the address of the robot
<A NAME="7768"></A>administrator, i.e. a person who looks after
<I>Sympa</I> (here <TT>postmastercru.fr</TT>).

<P>
<TT>sympa-owner</TT> is the return address for <I>Sympa</I> error
messages.

<P>
The alias bounce+* is dedicated to collect bounces where VERP (variable envelope return path) was actived. It is useful
if <TT> welcome_return_path unique </TT> or <TT> remind_return_path unique</TT> or the
<A NAME="7774"></A><TT>verp_rate</TT> parameter is no null for at least one list.

<P>
Don't forget to run <A NAME="7777"></A><TT>newaliases</TT> after any change to
the <A NAME="7780"></A><TT>/etc/aliases</TT> file!

<P>
Note: aliases based on <TT>listserv</TT> (in addition to those
based on <TT>sympa</TT>) can be added for the benefit of users
accustomed to the <TT>listserv</TT> and <TT>majordomo</TT> names.
For example:

<P><PRE>
listserv:          sympa
listserv-request:  sympa-request
majordomo:         sympa
listserv-owner:    sympa-owner
</PRE>

<P>

<H1><A NAME="SECTION00720000000000000000"></A>
<A NAME="list-aliases"></A>    <A NAME="777"></A>
    <A NAME="778"></A>
<BR>
6.2 List aliases
</H1>

<P>
For each new list, it is necessary to create up to six mail aliases (at least three).
If you managed to setup the alias manager (see next section) then <I>Sympa</I> will
install automatically the following aliases for you.

<P>
For example, to create the <TT>mylist</TT> list, the following
aliases must be added:

<P>
<BLOCKQUOTE><TABLE CELLPADDING=3>
<TR><TD ALIGN="LEFT"><TT>
        <TT>mylist</TT>:         </TT></TD>
<TD ALIGN="LEFT"><TT>
            "|/usr/local/sympa-stable/bin/queue mylist@my.domain.org"
            </TT></TD>
</TR>
<TR><TD ALIGN="LEFT"><TT> 
        <TT>mylist-request</TT>: </TT></TD>
<TD ALIGN="LEFT"><TT>
            "|/usr/local/sympa-stable/bin/queue mylist-request@my.domain.org"
            </TT></TD>
</TR>
<TR><TD ALIGN="LEFT"><TT> 
        <TT>mylist-editor</TT>:  </TT></TD>
<TD ALIGN="LEFT"><TT>
            "|/usr/local/sympa-stable/bin/queue mylist-editor@my.domain.org"
            </TT></TD>
</TR>
<TR><TD ALIGN="LEFT"><TT> 
        <TT>mylist-owner</TT>:   </TT></TD>
<TD ALIGN="LEFT"><TT>
            "|/usr/local/sympa-stable/bin/bouncequeue mylist@my.domain.org
            </TT></TD>
</TR>
<TR><TD ALIGN="LEFT"><TT> 
        <TT>mylist-subscribe</TT>:   </TT></TD>
<TD ALIGN="LEFT"><TT>
            "|/usr/local/sympa-stable/bin/queue mylist-subscribe@my.domain.org@my.domain.org"
            </TT></TD>
</TR>
<TR><TD ALIGN="LEFT"><TT> 
        <TT>mylist-unsubscribe</TT>: </TT></TD>
<TD ALIGN="LEFT"><TT>
            "|/usr/local/sympa-stable/bin/queue mylist-unsubscribe@my.domain.org"
            </TT></TD>
</TR>
<TR><TD></TD>
<TD></TD>
</TR>
</TABLE></BLOCKQUOTE>

<P>
The address <TT>mylist-request</TT> should correspond
to the person responsible for managing <TT>mylist</TT>
(the <A NAME="7797"></A>owner).  <I>Sympa</I> will forward messages for
<TT>mylist-request</TT> to the owner of <TT>mylist</TT>,
as defined in the <A NAME="7801"></A><TT>/usr/local/sympa-stable/expl/mylist/config</TT>
file.  Using this feature means you would not need to modify the
alias file if the owner of the list were to change.

<P>
Similarly, the address <TT>mylist-editor</TT> can be used
to contact the list editors if any are defined in
<A NAME="7805"></A><TT>/usr/local/sympa-stable/expl/mylist/config</TT>.  This address definition
is not compulsory.

<P>
The address <TT>mylist-owner</TT> is the address receiving
non-delivery reports (note that the -owner suffix can be customized, 
see&nbsp;<A HREF="node8.html#kw-return-path-suffix">7.8.4</A>, page&nbsp;<A HREF="node8.html#kw-return-path-suffix"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="crossref.png"></A>). 
The <A NAME="7809"></A><TT>bouncequeue</TT> program stores these messages 
in the <A NAME="7812"></A><TT>queuebounce</TT> directory. <A NAME="7815"></A><I>WWSympa</I> ((see&nbsp;<A HREF="node2.html#wwsympa">1.2</A>, page&nbsp;<A HREF="node2.html#wwsympa"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="crossref.png"></A>)
may then analyze them and provide a web access to them.

<P>
The address <TT>mylist-subscribe</TT> is an address enabling
users to subscribe in a manner which can easily be explained to them.
Beware: subscribing this way is so straightforward that you may find spammers
subscribing to your list by accident.

<P>
The address <TT>mylist-unsubscribe</TT> is the equivalent for
unsubscribing. By the way, the easier it is for users to unsubscribe, the easier it will
be for you to manage your list!

<P>

<H1><A NAME="SECTION00730000000000000000"></A>
<A NAME="alias-manager"></A>
<BR>
6.3 Alias manager
</H1>	

<P>
The <A NAME="7820"></A><TT>alias_manager.pl</TT> script does aliases management. It is run by <A NAME="7823"></A><I>WWSympa</I> and
 will install aliases for a new list and delete aliases for closed lists. 

<P>
The script expects the following arguments :

<OL>
<LI>add | del
</LI>
<LI><TT>&lt;</TT>list name<TT>&gt;</TT>
</LI>
<LI><TT>&lt;</TT>list domain<TT>&gt;</TT>
</LI>
</OL>
Example : <A NAME="7826"></A><TT>/usr/local/sympa-stable/bin/alias_manager.pl add mylistcru.fr</TT>

<P>
<A NAME="7829"></A><TT>/usr/local/sympa-stable/bin/alias_manager.pl</TT> works on the alias file as defined in <A NAME="7832"></A><TT>sympa.conf</TT>)
by the <A NAME="7835"></A>SENDMAIL_ALIASES  variable (default is <A NAME="7836"></A><TT>/etc/mail/sympa_aliases</TT>) in the main Makefile (see <A HREF="node4.html#makefile">3.3</A>,  page&nbsp;<A HREF="node4.html#makefile"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="crossref.png"></A>). You must refer to this aliases file in your <A NAME="7839"></A><TT>sendmail.mc</TT> (if using sendmail) :<PRE>
define(`ALIAS_FILE', `/etc/aliases,/etc/mail/sympa_aliases')dnl
</PRE>

<P>
<A NAME="7842"></A><TT>/usr/local/sympa-stable/bin/alias_manager.pl</TT> runs a <A NAME="7845"></A><TT>newaliases</TT> command (via <A NAME="7848"></A><TT>aliaswrapper</TT>), after any changes to aliases file.

<P>
If you manage virtual domains with your mail server, then you might want to change
the form of aliases used by the alias_manager. You can customize the <A NAME="7851"></A><TT>list_aliases</TT>
template that is parsed to generate list aliases (see<A HREF="node18.html#list-aliases-tpl">17.8.8</A>,  
page&nbsp;<A HREF="node18.html#list-aliases-tpl"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="crossref.png"></A>).

<P>
<A NAME="ldap-aliases"></A>A L. Marcotte has written a version of <A NAME="7854"></A><TT>ldap_alias_manager.pl</TT> that is LDAP enabled.
This script is distributed with Sympa distribution ; it needs to be customized with your LDAP parameters.

<P>

<H1><A NAME="SECTION00740000000000000000"></A>
<A NAME="virtual-domains"></A>
<BR>
6.4 Virtual domains
</H1>	

<P>
When using virtual domains with <A NAME="7857"></A><TT>sendmail</TT> or <A NAME="7860"></A><TT>postfix</TT>, you can't
refer to  <TT>mylist@my.domain.org</TT> on the right-hand side of an 
<A NAME="7864"></A><TT>/etc/aliases</TT> entry. You need to define an additional entry in a virtual table.
You can also add a unique entry, with a regular expression, for your domain. 

<P>
With Postfix, you should edit the <A NAME="7867"></A><TT>/etc/postfix/virtual.regexp</TT> file as follows :
<BLOCKQUOTE>
/<code>^</code>(.*)@my.domain.org$/	 my.domain.org-$1

</BLOCKQUOTE>
 Entries in the 'aliases' file will look like this :
<BLOCKQUOTE>
my.domain.org-sympa:   "|/usr/local/sympa-stable/bin/queue sympa@my.domain.org"
    .....
    my.domain.org-listA:   "|/usr/local/sympa-stable/bin/queue listA@my.domain.org"

</BLOCKQUOTE>

<P>
With Sendmail, add the following entry to <A NAME="7870"></A><TT>/etc/mail/virtusertable</TT> file :
<BLOCKQUOTE>
@my.domain.org       my.domain.org-%1%3

</BLOCKQUOTE>

<P>

<HR>
<!--Navigation Panel-->
<A NAME="tex2html875"
  HREF="node8.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html869"
  HREF="sympa.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html863"
  HREF="node6.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html871"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html873"
  HREF="node30.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html876"
  HREF="node8.html">7. sympa.conf parameters</A>
<B> Up:</B> <A NAME="tex2html870"
  HREF="sympa.html">Sympa Mailing Lists Management Software version</A>
<B> Previous:</B> <A NAME="tex2html864"
  HREF="node6.html">5. Upgrading Sympa</A>
 &nbsp; <B>  <A NAME="tex2html872"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html874"
  HREF="node30.html">Index</A></B> 
<!--End of Navigation Panel-->
<ADDRESS>
root
2006-09-25
</ADDRESS>
</BODY>
</HTML>
